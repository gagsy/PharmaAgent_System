services:
  pharma-app:
    build: .
    ports:
      - "8501:8501"
      - "8502:8502"
      - "3478:3478/udp" 
    volumes:
      # Mount the root once to provide all code and main.py
      - .:/usr/src/app
      # Explicitly mount data with Read/Write access for logs
      - ./data:/usr/src/app/data:rw
      - ./models:/usr/src/app/models
      - ./dataset:/usr/src/app/dataset
      - ./runs:/usr/src/app/runs
    
    environment:
      - STREAMLIT_SERVER_PORT=8501
      - STREAMLIT_SERVER_ADDRESS=0.0.0.0
      # Ensure Python doesn't buffer logs so they appear in Tab 2 instantly
      - PYTHONUNBUFFERED=1
    
    restart: unless-stopped